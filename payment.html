<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>Оплата взуття</title>
</head>
<body>
  <h2>Оплата взуття</h2>
  <p id="product-info"></p>
  <button id="pay-btn">Оплатити</button>

  <script>
    const params = new URLSearchParams(window.location.search);
    const product_id = params.get("product_id");
    const product_name = params.get("name");
    const size = params.get("size");
    const price = params.get("price");

    document.getElementById("product-info").innerText =
      `Ви замовили: ${product_name}, розмір ${size}, ціна: ${price} грн`;

    document.getElementById("pay-btn").onclick = function() {
      const form = document.createElement("form");
      form.method = "POST";
      form.action = "https://www.liqpay.ua/api/3/checkout";
      form.target = "_blank";

      const data = btoa(JSON.stringify({
        public_key: "sandbox_i2555075372",
        amount: price,
        currency: "UAH",
        description: `${product_name}, розмір ${size}`,
        order_id: `${product_id}_${size}_${Date.now()}`,
        sandbox: 1,
        result_url: `https://gdjsvavah.github.io/Gdjvsvavah.github.io/thanks.html?product_id=${product_id}&name=${encodeURIComponent(product_name)}&size=${size}&price=${price}`
      }));

      const signature = btoa(data); // для sandbox можна так

      const inputData = document.createElement("input");
      inputData.type = "hidden";
      inputData.name = "data";
      inputData.value = data;

      const inputSig = document.createElement("input");
      inputSig.type = "hidden";
      inputSig.name = "signature";
      inputSig.value = signature;

      form.appendChild(inputData);
      form.appendChild(inputSig);
      document.body.appendChild(form);
      form.submit();
    };
  </script>
</body>
</html>
